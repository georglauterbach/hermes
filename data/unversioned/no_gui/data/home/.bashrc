#! /usr/bin/env bash

# ██████╗  █████╗ ███████╗██╗  ██╗    ███████╗
# ██╔══██╗██╔══██╗██╔════╝██║  ██║    ██╔════╝
# ██████╔╝███████║███████╗███████║    ███████╗
# ██╔══██╗██╔══██║╚════██║██╔══██║    ╚════██║
# ██████╔╝██║  ██║███████║██║  ██║    ███████║
# ╚═════╝ ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝    ╚══════╝

# version       2.0.0
# executed by   Bash for non-login shells
# task          shell (Bash) initialization

# ! Do not edit this file.
# ! Use ${HOME}/.config/bash/{20-custom_early,99-custom_late}.sh instead.

function bash_setup() {
  local SETUP_FILE_PREFIX="${HOME}/.config/bash"

  function load_script() {
    local SCRIPT_FILE=${1:?Path to script to load is required}
    # shellcheck source=/dev/null
    [[ -e ${SCRIPT_FILE} ]] && [[ -r ${SCRIPT_FILE} ]] && source "${SCRIPT_FILE}"
    return 0
  }

  function load_helper() {
    local HELPER_SCRIPT_FILE="${SETUP_FILE_PREFIX}/${1}"
    load_script "${HELPER_SCRIPT_FILE}"
  }

  load_helper '00-base.sh'

  # if not running interactively, don't do anything
  [[ ${-} != *i* ]] && return 0

  load_helper '10-misc.sh'
  load_script "${HERMES_CUSTOM_EARLY_SCRIPT:-${SETUP_FILE_PREFIX}/20-custom_early.sh}"

  [[ ${HERMES_LOAD_EXTRA_PROGRAMS:-false} == 'true' ]] && load_helper '30-extra_programs.sh'
  [[ ${HERMES_LOAD_ALIASES:-false} == 'true' ]]        && load_helper '80-aliases.sh'
  [[ ${HERMES_LOAD_WRAPPER:-false} == 'true' ]]        && load_helper '90-wrapper.sh'

  load_script "${HERMES_CUSTOM_LATE_SCRIPT:-${SETUP_FILE_PREFIX}/99-custom_late.sh}"

  [[ -v BLE_VERSION ]] && ble-attach
}

bash_setup "${@}"
unset bash_setup load_script load_helper
